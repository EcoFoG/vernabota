<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="vernabota">
<title>Introduction to vernabota • vernabota</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to vernabota">
<meta property="og:description" content="vernabota">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vernabota</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/vernabota.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/model.html">Models</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="vernabota_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to vernabota</h1>
            
      
      
      <div class="d-none name"><code>vernabota.Rmd</code></div>
    </div>

    
    
<p>This document describes the methods and use of the package <em>vernabota</em> to gapfill missing botanical names using vernacular names, in the case of Guyafor census data. The objective is to obtain a chosen number of simulated communities for which individuals only identified with a vernacular name are given a botanical name based on probabilities of association of vernacular and botanical names. It is largely based on the work and codes from <span class="citation">Aubry-Kientz et al. (2013)</span> and <span class="citation">Mirabel (2018)</span>.</p>
<p>The models are described <a href="vignette(%22articles/model%22)">here</a>.</p>
<p>We set a seed for reproducibility.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">56</span><span class="op">)</span></code></pre></div>
<p>Some of the examples below require the package data.table.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="preparing-the-data">Preparing the data<a class="anchor" aria-label="anchor" href="#preparing-the-data"></a>
</h2>
<div class="section level3">
<h3 id="data-that-we-want-to-gapfill">Data that we want to gapfill<a class="anchor" aria-label="anchor" href="#data-that-we-want-to-gapfill"></a>
</h3>
<p>This algorithm works on a dataset formatted as it is when obtained using the function <em>EcoFoG::Guyafor2df</em> or from the online data plateform of Paracou.</p>
<p>There can be several censuses for a same plot (<em>i.e.</em> several lines per individual trees).</p>
<p>Here, we take the example of data from plot 6, census of 2016, and use subplot 1 as the dataset that we want to gapfill. We call this dataset <em>Data2fill</em>.</p>
<p>In this dataset, the column VernName should not contain any special character such as é, è or œ (data from the Guyafor database should not have these special characters).</p>
<p>We use the function <em>PrepData</em> to prepare the data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">vernabota</span><span class="op">)</span>
<span class="co">#&gt; Warning in register(): Can't find generic `scale_type` in package ggplot2 to</span>
<span class="co">#&gt; register S3 method.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Paracou6_2016</span><span class="op">)</span>
<span class="va">Data2fill</span> <span class="op">&lt;-</span> <span class="va">Paracou6_2016</span><span class="op">[</span><span class="va">Paracou6_2016</span><span class="op">$</span><span class="va">SubPlot</span><span class="op">==</span><span class="fl">1</span>,<span class="op">]</span>
<span class="va">Data2fill</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PrepData.html">PrepData</a></span><span class="op">(</span><span class="va">Data2fill</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">Data2fill</span><span class="op">)</span>
<span class="co">#&gt; Classes 'data.table' and 'data.frame':   976 obs. of  26 variables:</span>
<span class="co">#&gt;  $ Forest             : chr  "Paracou" "Paracou" "Paracou" "Paracou" ...</span>
<span class="co">#&gt;  $ Plot               : int  6 6 6 6 6 6 6 6 6 6 ...</span>
<span class="co">#&gt;  $ PlotArea           : num  6.25 6.25 6.25 6.25 6.25 6.25 6.25 6.25 6.25 6.25 ...</span>
<span class="co">#&gt;  $ SubPlot            : int  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ idTree             : Factor w/ 976 levels "100621","100622",..: 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ Xfield             : num  23 28.5 14 9.5 10 5 5 3.5 5 8.5 ...</span>
<span class="co">#&gt;  $ Yfield             : num  236 248 210 126 128 ...</span>
<span class="co">#&gt;  $ Xutm               : num  286421 286423 286418 286435 286435 ...</span>
<span class="co">#&gt;  $ Yutm               : num  583171 583185 583144 583062 583063 ...</span>
<span class="co">#&gt;  $ Lat                : num  5.27 5.27 5.27 5.27 5.27 ...</span>
<span class="co">#&gt;  $ Lon                : num  -52.9 -52.9 -52.9 -52.9 -52.9 ...</span>
<span class="co">#&gt;  $ Family             : chr  "Euphorbiaceae" "Arecaceae" "Sapotaceae" "Humiriaceae" ...</span>
<span class="co">#&gt;  $ Genus              : chr  "Sandwithia" "Oenocarpus" "Micropholis" "Sacoglottis" ...</span>
<span class="co">#&gt;  $ Species            : chr  "guyanensis" "bataua" "guyanensis" "guianensis" ...</span>
<span class="co">#&gt;  $ BotaSource         : chr  "Bota" "Bota" "Bota" "Bota" ...</span>
<span class="co">#&gt;  $ BotaCertainty      : Factor w/ 6 levels "-1","0","1","2",..: 6 6 6 6 6 6 6 5 6 6 ...</span>
<span class="co">#&gt;  $ VernName           : Factor w/ 110 levels "-","acacia franc",..: 102 79 14 91 18 97 14 86 75 70 ...</span>
<span class="co">#&gt;  $ CensusYear         : int  2016 2016 2016 2016 2016 2016 2016 2016 2016 2016 ...</span>
<span class="co">#&gt;  $ CensusDate         : chr  "2016-09-14" "2016-09-14" "2016-09-14" "2016-09-14" ...</span>
<span class="co">#&gt;  $ CensusDateCertainty: int  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ CodeAlive          : int  1 1 1 1 1 1 1 1 1 0 ...</span>
<span class="co">#&gt;  $ MeasCode           : int  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ Circ               : num  42 59.5 74 132.5 46 ...</span>
<span class="co">#&gt;  $ CircCorr           : num  42 59.5 74 132.5 46 ...</span>
<span class="co">#&gt;  $ CorrCode           : chr  "0" "0" "0" "0" ...</span>
<span class="co">#&gt;  $ GenSp              : Factor w/ 188 levels "Abarema-jupunba",..: 148 116 107 147 169 186 128 74 117 88 ...</span>
<span class="co">#&gt;  - attr(*, ".internal.selfref")=&lt;externalptr&gt; </span>
<span class="co">#&gt;  - attr(*, "index")= int(0) </span>
<span class="co">#&gt;   ..- attr(*, "__BotaSource")= int [1:976] 1 2 3 4 5 6 7 8 9 10 ...</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="prior-expert-knowledge-on-possible-associations">Prior: expert knowledge on possible associations<a class="anchor" aria-label="anchor" href="#prior-expert-knowledge-on-possible-associations"></a>
</h3>
<p>The prior is a data.frame with vernacular names in columns and botanical names in rows (given in 3 column Family, Genus and Species. For a given vernacular name and a given botanical name, the value is 1 if the association is possible, according to expert knowledge, and 0 if not.</p>
<p>We propose three prior files resulting from the work of Jean-Maurice MadKau <span class="citation">Madkaud (2012)</span>, updated using the code <em>5_Dev/Prior_Verna_Bota_Name_Cleaning/Prior_Verna_Bota_Name_Cleaning.Rmd</em> in January 2022.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">PriorAllFG_20220126</span><span class="op">)</span>
<span class="va">PriorAllFG</span> <span class="op">&lt;-</span> <span class="va">PriorAllFG_20220126</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">PriorAllFG</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    1657 obs. of  10 variables:</span>
<span class="co">#&gt;  $ Family          : chr  "Fabaceae" "Chrysobalanaceae" "Melastomataceae" "Opiliaceae" ...</span>
<span class="co">#&gt;  $ Genus           : chr  "Abarema" "Acioa" "Aciotis" "Agonandra" ...</span>
<span class="co">#&gt;  $ Species         : chr  "jupunba" "guianensis" "purpurascens" "silvatica" ...</span>
<span class="co">#&gt;  $ PresentInGuyaFor: logi  TRUE FALSE FALSE TRUE TRUE FALSE ...</span>
<span class="co">#&gt;  $ acacia franc    : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ acajou de guyane: num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ adugue          : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ aganananga      : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ aganiamai       : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ agui            : num  0 0 0 0 0 0 0 0 0 0 ...</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">PriorParacouNew_20220126</span><span class="op">)</span>
<span class="va">PriorParacouNew</span> <span class="op">&lt;-</span> <span class="va">PriorParacouNew_20220126</span>
<span class="co"># str(PriorParacouNew[,1:10])</span>

<span class="co"># data(PriorParacouOld_20220126)</span>
<span class="co"># PriorParacouOld &lt;- PriorParacouOld_20220126</span>
<span class="co"># str(PriorParacouOld[,1:10])</span></code></pre></div>
<p>We use the function <em>PrepPrior</em> to prepare the prior. Here we use the default settings because we want to remove the botanical names with non-determined species, and the botanical names not in Guyafor from the prior. The reason is that these names would always lead to incorrect association when using the <em>CompareSim</em> function (see below). However, one may decide to keep them, this would lead to</p>
<ul>
<li><p>possible associations with a botanical name of the form <em>Genus-Indet.</em> with a BotaCodeCor=“AssoByGenus” or “AssoByFam” (with RemoveIndetSp==TRUE) .</p></li>
<li><p>possible associations with a botanical name that has never been observed in Guyafor (with RemoveNotGuyafor==TRUE).</p></li>
</ul>
<p>In these latter cases, only the prior information would be used.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">PriorAllFG</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PrepPrior.html">PrepPrior</a></span><span class="op">(</span><span class="va">PriorAllFG</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">PriorAllFG</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Classes 'data.table' and 'data.frame':   681 obs. of  10 variables:</span>
<span class="co">#&gt;  $ Family          : chr  "Fabaceae" "Opiliaceae" "Lauraceae" "Lauraceae" ...</span>
<span class="co">#&gt;  $ Genus           : chr  "Abarema" "Agonandra" "Aiouea" "Aiouea" ...</span>
<span class="co">#&gt;  $ Species         : chr  "jupunba" "silvatica" "guianensis" "laevis" ...</span>
<span class="co">#&gt;  $ acacia franc    : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ acajou de guyane: num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ adugue          : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ aganananga      : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ aganiamai       : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ agui            : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ agusiton        : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  - attr(*, ".internal.selfref")=&lt;externalptr&gt;</span>

<span class="va">PriorParacouNew</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PrepPrior.html">PrepPrior</a></span><span class="op">(</span><span class="va">PriorParacouNew</span><span class="op">)</span>
<span class="co"># str(PriorParacouNew[,1:10])</span>
<span class="co"># </span>
<span class="co"># PriorParacouOld &lt;- PrepPrior(PriorParacouOld)</span>
<span class="co"># str(PriorParacouOld[,1:10])</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="observation-data-to-update-the-prior">Observation data to update the prior<a class="anchor" aria-label="anchor" href="#observation-data-to-update-the-prior"></a>
</h3>
<p>To built the matrix of association between vernacular and scientific names, we can either use the same dataset than the one for which we want to perform the association or another dataset. The user needs to carefully think this choice through. Using the same dataset can lead to underestimating diversity as it consider that there cannot be any dispersal of species from outside. Using a too wide data set could lead to associating species that are not present in the area.</p>
<p>There can be several censuses for a same plot (<em>i.e.</em> several lines per individual trees).</p>
<p>In this dataset, the column VernName should not contain any special character such as é, è or œ (data from the Guyafor database should not have these special characters).</p>
<p>Here, we use data from plot 6 (all four subplots), census of 2016. We call this dataset <em>DataAsso</em>.</p>
<p>We use the function <em>PrepData</em> to prepare the data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">DataAsso</span> <span class="op">&lt;-</span> <span class="va">Paracou6_2016</span>
<span class="va">DataAsso</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PrepData.html">PrepData</a></span><span class="op">(</span><span class="va">DataAsso</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">DataAsso</span><span class="op">)</span>
<span class="co">#&gt; Classes 'data.table' and 'data.frame':   3620 obs. of  26 variables:</span>
<span class="co">#&gt;  $ Forest             : chr  "Paracou" "Paracou" "Paracou" "Paracou" ...</span>
<span class="co">#&gt;  $ Plot               : int  6 6 6 6 6 6 6 6 6 6 ...</span>
<span class="co">#&gt;  $ PlotArea           : num  6.25 6.25 6.25 6.25 6.25 6.25 6.25 6.25 6.25 6.25 ...</span>
<span class="co">#&gt;  $ SubPlot            : int  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ idTree             : Factor w/ 3620 levels "100621","100622",..: 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ Xfield             : num  23 28.5 14 9.5 10 5 5 3.5 5 8.5 ...</span>
<span class="co">#&gt;  $ Yfield             : num  236 248 210 126 128 ...</span>
<span class="co">#&gt;  $ Xutm               : num  286421 286423 286418 286435 286435 ...</span>
<span class="co">#&gt;  $ Yutm               : num  583171 583185 583144 583062 583063 ...</span>
<span class="co">#&gt;  $ Lat                : num  5.27 5.27 5.27 5.27 5.27 ...</span>
<span class="co">#&gt;  $ Lon                : num  -52.9 -52.9 -52.9 -52.9 -52.9 ...</span>
<span class="co">#&gt;  $ Family             : chr  "Euphorbiaceae" "Arecaceae" "Sapotaceae" "Humiriaceae" ...</span>
<span class="co">#&gt;  $ Genus              : chr  "Sandwithia" "Oenocarpus" "Micropholis" "Sacoglottis" ...</span>
<span class="co">#&gt;  $ Species            : chr  "guyanensis" "bataua" "guyanensis" "guianensis" ...</span>
<span class="co">#&gt;  $ BotaSource         : chr  "Bota" "Bota" "Bota" "Bota" ...</span>
<span class="co">#&gt;  $ BotaCertainty      : Factor w/ 6 levels "-1","0","1","2",..: 6 6 6 6 6 6 6 5 6 6 ...</span>
<span class="co">#&gt;  $ VernName           : Factor w/ 156 levels "-","acacia franc",..: 146 112 23 131 29 138 23 123 105 100 ...</span>
<span class="co">#&gt;  $ CensusYear         : int  2016 2016 2016 2016 2016 2016 2016 2016 2016 2016 ...</span>
<span class="co">#&gt;  $ CensusDate         : chr  "2016-09-14" "2016-09-14" "2016-09-14" "2016-09-14" ...</span>
<span class="co">#&gt;  $ CensusDateCertainty: int  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ CodeAlive          : int  1 1 1 1 1 1 1 1 1 0 ...</span>
<span class="co">#&gt;  $ MeasCode           : int  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ Circ               : num  42 59.5 74 132.5 46 ...</span>
<span class="co">#&gt;  $ CircCorr           : num  42 59.5 74 132.5 46 ...</span>
<span class="co">#&gt;  $ CorrCode           : chr  "0" "0" "0" "0" ...</span>
<span class="co">#&gt;  $ GenSp              : Factor w/ 321 levels "Abarema-jupunba",..: 253 193 175 251 289 316 215 118 195 142 ...</span>
<span class="co">#&gt;  - attr(*, ".internal.selfref")=&lt;externalptr&gt; </span>
<span class="co">#&gt;  - attr(*, "index")= int(0) </span>
<span class="co">#&gt;   ..- attr(*, "__BotaSource")= int [1:3620] 1 2 3 4 5 6 7 8 9 10 ...</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="running-some-simmulations-using-the-function-simfullcom">Running some simmulations using the function SimFullCom<a class="anchor" aria-label="anchor" href="#running-some-simmulations-using-the-function-simfullcom"></a>
</h2>
<p><em>NB</em>: for these examples, a low number of simulations is used. For real tests, a higher number of simulations should be performed.</p>
<p>The <em>SimFullCom</em> function returns the original dataset with two additional columns:</p>
<ul>
<li><p>GensSpCor: The Genus and species after gap filling</p></li>
<li><p>BotaCorCode : the type of correction (see section <em>Possible types of gapfilling</em> in this vignette, and the help of the <em>SimFullCom</em> function).</p></li>
</ul>
<p>In cases where the original data contained several censuses of a same plots (<em>i.e.</em> several lines per individual trees), the output keeps the several censuses. For a given simulations, all observations of a same tree have the same botanical names associated.</p>
<div class="section level3">
<h3 id="example-1-using-the-same-dataset-for-data2fill-and-dataasso-without-prior">Example 1: using the same dataset for Data2fill and DataAsso, without prior<a class="anchor" aria-label="anchor" href="#example-1-using-the-same-dataset-for-data2fill-and-dataasso-without-prior"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">DataNSim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SimFullCom.html">SimFullCom</a></span><span class="op">(</span><span class="va">Data2fill</span>, NSim<span class="op">=</span><span class="fl">2</span>, eps<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">DataNSim</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; List of 2</span>
<span class="co">#&gt;  $ :Classes 'data.table' and 'data.frame':   976 obs. of  28 variables:</span>
<span class="co">#&gt;   ..- attr(*, ".internal.selfref")=&lt;externalptr&gt; </span>
<span class="co">#&gt;   ..- attr(*, "sorted")= chr "idTree"</span>
<span class="co">#&gt;  $ :Classes 'data.table' and 'data.frame':   976 obs. of  28 variables:</span>
<span class="co">#&gt;   ..- attr(*, ".internal.selfref")=&lt;externalptr&gt; </span>
<span class="co">#&gt;   ..- attr(*, "sorted")= chr "idTree"</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">DataNSim</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;  [1] "idTree"              "Forest"              "Plot"               </span>
<span class="co">#&gt;  [4] "PlotArea"            "SubPlot"             "Xfield"             </span>
<span class="co">#&gt;  [7] "Yfield"              "Xutm"                "Yutm"               </span>
<span class="co">#&gt; [10] "Lat"                 "Lon"                 "Family"             </span>
<span class="co">#&gt; [13] "Genus"               "Species"             "BotaSource"         </span>
<span class="co">#&gt; [16] "BotaCertainty"       "VernName"            "CensusYear"         </span>
<span class="co">#&gt; [19] "CensusDate"          "CensusDateCertainty" "CodeAlive"          </span>
<span class="co">#&gt; [22] "MeasCode"            "Circ"                "CircCorr"           </span>
<span class="co">#&gt; [25] "CorrCode"            "GenSp"               "GensSpCor"          </span>
<span class="co">#&gt; [28] "BotaCorCode"</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">DataNSim</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">BotaCorCode</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    fullyDet   Det2Genus       NoCor   AssoByFam  AssoByVern     Det2Fam </span>
<span class="co">#&gt;         953           2           1           2          11           1 </span>
<span class="co">#&gt; AssoByGenus </span>
<span class="co">#&gt;           6</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-2-using-different-dataset-for-data2fill-and-dataasso-with-a-prior-different-weighing-of-the-prior-and-the-observations">Example 2: using different dataset for Data2fill and DataAsso, with a prior (different weighing of the prior and the observations)<a class="anchor" aria-label="anchor" href="#example-2-using-different-dataset-for-data2fill-and-dataasso-with-a-prior-different-weighing-of-the-prior-and-the-observations"></a>
</h3>
<p>Here we have a weigth of 0.2 for the prior and of 0.8 for the observations.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">DataNSim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SimFullCom.html">SimFullCom</a></span><span class="op">(</span>Data2fill<span class="op">=</span><span class="va">Data2fill</span>, DataAsso<span class="op">=</span><span class="va">DataAsso</span>, 
                       prior<span class="op">=</span><span class="va">PriorAllFG</span>, wp<span class="op">=</span><span class="fl">0.2</span>, NSim<span class="op">=</span><span class="fl">2</span>, eps<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span>
<span class="co">#str(DataNSim, max.level = 1)</span>
<span class="co">#colnames(DataNSim[[1]])</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">DataNSim</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">BotaCorCode</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    fullyDet   AssoByFam  AssoByVern     Det2Fam   Det2Genus AssoByGenus </span>
<span class="co">#&gt;         953           2          12           1           1           7</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-3-getting-the-more-likely-associations-using-determtrue">Example 3: getting the more likely associations (using Determ=TRUE)<a class="anchor" aria-label="anchor" href="#example-3-getting-the-more-likely-associations-using-determtrue"></a>
</h3>
<p>As we want to simulate the more likely associations, we set NSim to 1.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">DataNSim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SimFullCom.html">SimFullCom</a></span><span class="op">(</span>Data2fill<span class="op">=</span><span class="va">Data2fill</span>, DataAsso<span class="op">=</span><span class="va">DataAsso</span>, 
                       prior<span class="op">=</span><span class="va">PriorAllFG</span>, wp<span class="op">=</span><span class="fl">0.2</span>, NSim<span class="op">=</span><span class="fl">1</span>, eps<span class="op">=</span><span class="fl">0.01</span>, Determ<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#str(DataNSim, max.level = 1)</span>
<span class="co">#colnames(DataNSim[[1]])</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">DataNSim</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">BotaCorCode</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;          fullyDet   AssoByFamDeterm  AssoByVernDeterm           Det2Fam </span>
<span class="co">#&gt;               953                 2                12                 1 </span>
<span class="co">#&gt;         Det2Genus AssoByGenusDeterm </span>
<span class="co">#&gt;                 1                 7</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="comparing-different-settings-for-the-simulations-using-the-function-comparesim">Comparing different settings for the simulations using the function CompareSim<a class="anchor" aria-label="anchor" href="#comparing-different-settings-for-the-simulations-using-the-function-comparesim"></a>
</h2>
<p><em>NB</em>: for these examples, a low number of simulations is used. For real tests, a higher number of simulations should be performed.</p>
<div class="section level3">
<h3 id="comparing-different-settings">Comparing different settings<a class="anchor" aria-label="anchor" href="#comparing-different-settings"></a>
</h3>
<p>The choice of the settings used for the gapfilling is important for the quality of the estimation. It is specific to the study and the dataset of the user, so it is interesting to compare different settings and to choose the one that performs the best:</p>
<ul>
<li><p>choice of observation data (DataAsso): Using the same dataset (or a dataset to limited in its size or spatial extent) can lead to underestimating diversity as it underestimate the<br>
dispersal of species from outside. Using a too wide data set could lead to associating species that are not present in the area.</p></li>
<li><p>the choice of the prior data depends on the team that has performed the vernacular identification and on the spatial extent of the data to gapfill and of the prior.</p></li>
<li><p>the relative weights given to the prior and the observation depends on the quantity and quality of information brought by the prior and the observation.</p></li>
<li><p>the effect of the value of <span class="math inline">\(\epsilon\)</span> can also be tested.</p></li>
<li><p>the overall percentatge of trees used for testing (<em>pc2fill</em>) can also be tested.</p></li>
<li><p>the percentage of trees that we consider determined to the family (<em>pcFamilyDet</em>) or to the genus (<em>pcGenusDet</em>) should logically be chosen to be similar to these in the data set we want to gapfill (but this can also be changed).</p></li>
</ul>
<p>For this, we use the function <em>CompareSim</em>. This function “masks” the identification of the trees fully identified and test if it can be successfully retreived with the setting chosen. The proportion of correct association is called accuracy.</p>
<p>We first create lists for the data to gapfill, the priors and the observation data<br>
that we want to test:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">D2fill</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Data2fill</span><span class="op">)</span>                   <span class="co"># data to gapfill</span>
<span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">PriorAllFG</span>, <span class="va">PriorParacouNew</span><span class="op">)</span> <span class="co"># priors</span>
<span class="va">DAsso</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="va">DataAsso</span><span class="op">)</span>               <span class="co"># observation data</span></code></pre></div>
<p>Then we create the Param data.frame to explicit the different scenarios to test:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,  <span class="co"># here, we used the first prior </span>
                    <span class="co"># of the list for scenario 1, 2, 4 and 5 and the seccond for scenario 3</span>
                    dataFill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,
                    dataAsso <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, <span class="co"># for the second scenario dataAsso is NULL (the data to gapfill are used)</span>
                    weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.2</span>,<span class="fl">0.8</span><span class="op">)</span>,
                    NbSim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>,
                    pc2fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>,
                    pcFamilyDet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span><span class="op">)</span>,
                    pcGenusDet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span><span class="op">)</span>,
                    eps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">0.01</span>,<span class="fl">0.01</span>,<span class="fl">0.01</span>,<span class="fl">0.01</span><span class="op">)</span>,
                    Determ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span><span class="op">)</span>,
                    Results_Simulations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="va">Param</span>
<span class="co">#&gt;   priors dataFill dataAsso weights NbSim pc2fill pcFamilyDet pcGenusDet  eps</span>
<span class="co">#&gt; 1      1        1        2     0.5    10      10          25         25 0.01</span>
<span class="co">#&gt; 2      1        1        1     0.5    10      10          25         25 0.01</span>
<span class="co">#&gt; 3      2        1        2     0.5    10      10          25         25 0.01</span>
<span class="co">#&gt; 4      1        1        2     0.2    10      10          25         25 0.01</span>
<span class="co">#&gt; 5      1        1        2     0.8    10      10          25         25 0.01</span>
<span class="co">#&gt;   Determ Results_Simulations</span>
<span class="co">#&gt; 1  FALSE               FALSE</span>
<span class="co">#&gt; 2  FALSE               FALSE</span>
<span class="co">#&gt; 3  FALSE               FALSE</span>
<span class="co">#&gt; 4  FALSE               FALSE</span>
<span class="co">#&gt; 5  FALSE               FALSE</span></code></pre></div>
<p>We can then run <em>CompareSim</em>, visualise the scenarios and their results using <em>summary</em> and plot their accuracy using <em>plot</em>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">VBS_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CompareSim.html">CompareSim</a></span><span class="op">(</span>Param <span class="op">=</span> <span class="va">Param</span> ,
                       priors <span class="op">=</span> <span class="va">priors</span>, D2fill <span class="op">=</span> <span class="va">D2fill</span>, DAsso <span class="op">=</span> <span class="va">DAsso</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">VBS_test</span><span class="op">)</span>
<span class="co">#&gt; scenario a </span>
<span class="co">#&gt; 10  repetition(s) with priors nb 1 , Data2Fill nb 1 , dataAsso nb 2 , weights nb 0.5 , pc2fill 10 , and eps 0.01 </span>
<span class="co">#&gt;        0%       25%       50%       75%      100% </span>
<span class="co">#&gt; 0.4693878 0.5433673 0.5663265 0.5714286 0.5918367 </span>
<span class="co">#&gt; scenario b </span>
<span class="co">#&gt; 10  repetition(s) with priors nb 1 , Data2Fill nb 1 , dataAsso nb 1 , weights nb 0.5 , pc2fill 10 , and eps 0.01 </span>
<span class="co">#&gt;        0%       25%       50%       75%      100% </span>
<span class="co">#&gt; 0.4387755 0.4515306 0.4744898 0.5102041 0.5612245 </span>
<span class="co">#&gt; scenario c </span>
<span class="co">#&gt; 10  repetition(s) with priors nb 2 , Data2Fill nb 1 , dataAsso nb 2 , weights nb 0.5 , pc2fill 10 , and eps 0.01 </span>
<span class="co">#&gt;        0%       25%       50%       75%      100% </span>
<span class="co">#&gt; 0.5102041 0.5331633 0.5765306 0.5918367 0.6020408 </span>
<span class="co">#&gt; scenario d </span>
<span class="co">#&gt; 10  repetition(s) with priors nb 1 , Data2Fill nb 1 , dataAsso nb 2 , weights nb 0.2 , pc2fill 10 , and eps 0.01 </span>
<span class="co">#&gt;        0%       25%       50%       75%      100% </span>
<span class="co">#&gt; 0.5306122 0.5408163 0.5510204 0.5790816 0.6020408 </span>
<span class="co">#&gt; scenario e </span>
<span class="co">#&gt; 10  repetition(s) with priors nb 1 , Data2Fill nb 1 , dataAsso nb 2 , weights nb 0.8 , pc2fill 10 , and eps 0.01 </span>
<span class="co">#&gt;        0%       25%       50%       75%      100% </span>
<span class="co">#&gt; 0.4591837 0.4795918 0.5051020 0.5102041 0.5306122</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">VBS_test</span><span class="op">)</span></code></pre></div>
<p><img src="vernabota_files/figure-html/Compare-1.png" width="80%"></p>
</div>
<div class="section level3">
<h3 id="testing-deterministic-associations">Testing deterministic associations<a class="anchor" aria-label="anchor" href="#testing-deterministic-associations"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,  
                    dataFill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,
                    dataAsso <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, 
                    weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.2</span>,<span class="fl">0.8</span><span class="op">)</span>,
                    NbSim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>,
                    pc2fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>,
                    pcFamilyDet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span><span class="op">)</span>,
                    pcGenusDet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span><span class="op">)</span>,
                    eps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">0.01</span>,<span class="fl">0.01</span>,<span class="fl">0.01</span>,<span class="fl">0.01</span><span class="op">)</span>,
                    Determ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">TRUE</span><span class="op">)</span>,
                    Results_Simulations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="va">Param</span>
<span class="co">#&gt;   priors dataFill dataAsso weights NbSim pc2fill pcFamilyDet pcGenusDet  eps</span>
<span class="co">#&gt; 1      1        1        2     0.5    10      10          25         25 0.01</span>
<span class="co">#&gt; 2      1        1        1     0.5    10      10          25         25 0.01</span>
<span class="co">#&gt; 3      2        1        2     0.5    10      10          25         25 0.01</span>
<span class="co">#&gt; 4      1        1        2     0.2    10      10          25         25 0.01</span>
<span class="co">#&gt; 5      1        1        2     0.8    10      10          25         25 0.01</span>
<span class="co">#&gt;   Determ Results_Simulations</span>
<span class="co">#&gt; 1   TRUE               FALSE</span>
<span class="co">#&gt; 2   TRUE               FALSE</span>
<span class="co">#&gt; 3   TRUE               FALSE</span>
<span class="co">#&gt; 4   TRUE               FALSE</span>
<span class="co">#&gt; 5   TRUE               FALSE</span></code></pre></div>
<p>Here there will be lots of warning messages (not displayed here) in cases when two associations are equality likely. This also explain the variability of the accuracy plotted.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">VBS_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CompareSim.html">CompareSim</a></span><span class="op">(</span>Param <span class="op">=</span> <span class="va">Param</span> ,
                       priors <span class="op">=</span> <span class="va">priors</span>, D2fill <span class="op">=</span> <span class="va">D2fill</span>, DAsso <span class="op">=</span> <span class="va">DAsso</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">VBS_test</span><span class="op">)</span>
<span class="co">#&gt; scenario a </span>
<span class="co">#&gt; 10  repetition(s) with priors nb 1 , Data2Fill nb 1 , dataAsso nb 2 , weights nb 0.5 , pc2fill 10 , and eps 0.01 </span>
<span class="co">#&gt;        0%       25%       50%       75%      100% </span>
<span class="co">#&gt; 0.6938776 0.6938776 0.6938776 0.6938776 0.6938776 </span>
<span class="co">#&gt; scenario b </span>
<span class="co">#&gt; 10  repetition(s) with priors nb 1 , Data2Fill nb 1 , dataAsso nb 1 , weights nb 0.5 , pc2fill 10 , and eps 0.01 </span>
<span class="co">#&gt;        0%       25%       50%       75%      100% </span>
<span class="co">#&gt; 0.6428571 0.6428571 0.6428571 0.6530612 0.6530612 </span>
<span class="co">#&gt; scenario c </span>
<span class="co">#&gt; 10  repetition(s) with priors nb 2 , Data2Fill nb 1 , dataAsso nb 2 , weights nb 0.5 , pc2fill 10 , and eps 0.01 </span>
<span class="co">#&gt;        0%       25%       50%       75%      100% </span>
<span class="co">#&gt; 0.7653061 0.7653061 0.7653061 0.7653061 0.7653061 </span>
<span class="co">#&gt; scenario d </span>
<span class="co">#&gt; 10  repetition(s) with priors nb 1 , Data2Fill nb 1 , dataAsso nb 2 , weights nb 0.2 , pc2fill 10 , and eps 0.01 </span>
<span class="co">#&gt;        0%       25%       50%       75%      100% </span>
<span class="co">#&gt; 0.7142857 0.7244898 0.7244898 0.7346939 0.7346939 </span>
<span class="co">#&gt; scenario e </span>
<span class="co">#&gt; 10  repetition(s) with priors nb 1 , Data2Fill nb 1 , dataAsso nb 2 , weights nb 0.8 , pc2fill 10 , and eps 0.01 </span>
<span class="co">#&gt;        0%       25%       50%       75%      100% </span>
<span class="co">#&gt; 0.6632653 0.6658163 0.6734694 0.6734694 0.6734694</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">VBS_test</span><span class="op">)</span></code></pre></div>
<p><img src="vernabota_files/figure-html/Comparedeter-1.png" width="80%"></p>
</div>
<div class="section level3">
<h3 id="checking-stability-of-association-accuracy">Checking stability of association accuracy<a class="anchor" aria-label="anchor" href="#checking-stability-of-association-accuracy"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,  
                    dataFill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,
                    dataAsso <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,
                    weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>,
                    NbSim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>,
                    pc2fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>,
                    pcFamilyDet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span><span class="op">)</span>,
                    pcGenusDet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span><span class="op">)</span>,
                    eps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">0.01</span>,<span class="fl">0.01</span><span class="op">)</span>,
                    Determ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span><span class="op">)</span>,
                    Results_Simulations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="va">Param</span>
<span class="co">#&gt;   priors dataFill dataAsso weights NbSim pc2fill pcFamilyDet pcGenusDet  eps</span>
<span class="co">#&gt; 1      2        1        2     0.5    10      10          25         25 0.01</span>
<span class="co">#&gt; 2      2        1        2     0.5    10      10          25         25 0.01</span>
<span class="co">#&gt; 3      2        1        2     0.5    10      10          25         25 0.01</span>
<span class="co">#&gt;   Determ Results_Simulations</span>
<span class="co">#&gt; 1  FALSE               FALSE</span>
<span class="co">#&gt; 2  FALSE               FALSE</span>
<span class="co">#&gt; 3  FALSE               FALSE</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">VBS_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CompareSim.html">CompareSim</a></span><span class="op">(</span>Param <span class="op">=</span> <span class="va">Param</span> ,
                       priors <span class="op">=</span> <span class="va">priors</span>, D2fill <span class="op">=</span> <span class="va">D2fill</span>, DAsso <span class="op">=</span> <span class="va">DAsso</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">VBS_test</span><span class="op">)</span>
<span class="co">#&gt; scenario a </span>
<span class="co">#&gt; 10  repetition(s) with priors nb 2 , Data2Fill nb 1 , dataAsso nb 2 , weights nb 0.5 , pc2fill 10 , and eps 0.01 </span>
<span class="co">#&gt;        0%       25%       50%       75%      100% </span>
<span class="co">#&gt; 0.5612245 0.5739796 0.5816327 0.6096939 0.6224490 </span>
<span class="co">#&gt; scenario b </span>
<span class="co">#&gt; 10  repetition(s) with priors nb 2 , Data2Fill nb 1 , dataAsso nb 2 , weights nb 0.5 , pc2fill 10 , and eps 0.01 </span>
<span class="co">#&gt;        0%       25%       50%       75%      100% </span>
<span class="co">#&gt; 0.4489796 0.4821429 0.5000000 0.5255102 0.5408163 </span>
<span class="co">#&gt; scenario c </span>
<span class="co">#&gt; 10  repetition(s) with priors nb 2 , Data2Fill nb 1 , dataAsso nb 2 , weights nb 0.5 , pc2fill 10 , and eps 0.01 </span>
<span class="co">#&gt;        0%       25%       50%       75%      100% </span>
<span class="co">#&gt; 0.5000000 0.5433673 0.5561224 0.5790816 0.6122449</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">VBS_test</span><span class="op">)</span></code></pre></div>
<p><img src="vernabota_files/figure-html/Compare_stab-1.png" width="80%"></p>
<p>Here we seen that we could increase the number of simulations.</p>
</div>
<div class="section level3">
<h3 id="examining-results-associations">Examining results associations<a class="anchor" aria-label="anchor" href="#examining-results-associations"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, 
                    dataFill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,
                    dataAsso <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, 
                    weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>,
                    NbSim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,
                    pc2fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,
                    pcFamilyDet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,
                    pcGenusDet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,
                    eps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span>,
                    Determ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span>,
                    Results_Simulations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">Param</span>
<span class="co">#&gt;   priors dataFill dataAsso weights NbSim pc2fill pcFamilyDet pcGenusDet  eps</span>
<span class="co">#&gt; 1      2        1        2     0.5    10      10          25         25 0.01</span>
<span class="co">#&gt;   Determ Results_Simulations</span>
<span class="co">#&gt; 1  FALSE                TRUE</span></code></pre></div>
<p>We now want to examine the association tree by tree. The simulations of each scenario (here just one) can be retrieved as a list of data.table.</p>
<p>In cases where the original data contained several censuses of a same plots (<em>i.e.</em> several lines per individual trees), the output contained in <em>results</em> keeps only one line per individual, and only a subset of colums from the original dataset (thes ones that don’t change between censuses).</p>
<p>We can then look at each of the simulations: <em>TestData</em> indicates if the tree was used for test subset, and <em>ValidAsso</em> if the botanical association was correct.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">VBS_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CompareSim.html">CompareSim</a></span><span class="op">(</span>Param <span class="op">=</span> <span class="va">Param</span> ,
                       priors <span class="op">=</span> <span class="va">priors</span>, D2fill <span class="op">=</span> <span class="va">D2fill</span>, DAsso <span class="op">=</span> <span class="va">DAsso</span><span class="op">)</span>
<span class="va">ResL</span> <span class="op">&lt;-</span> <span class="va">VBS_test</span><span class="op">@</span><span class="va">results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co"># here we get all the simulation of scenario 1</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">ResL</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># first simulation</span>
<span class="co">#&gt; Classes 'data.table' and 'data.frame':   976 obs. of  12 variables:</span>
<span class="co">#&gt;  $ idTree       : Factor w/ 976 levels "100621","100622",..: 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ Family       : chr  "Euphorbiaceae" "Arecaceae" "Sapotaceae" "Humiriaceae" ...</span>
<span class="co">#&gt;  $ Genus        : chr  "Sandwithia" "Oenocarpus" "Micropholis" "Sacoglottis" ...</span>
<span class="co">#&gt;  $ Species      : chr  "guyanensis" "bataua" "guyanensis" "guianensis" ...</span>
<span class="co">#&gt;  $ BotaSource   : chr  "Bota" "Bota" "Bota" "Bota" ...</span>
<span class="co">#&gt;  $ BotaCertainty: Factor w/ 6 levels "-1","0","1","2",..: 6 6 6 6 6 6 6 5 6 6 ...</span>
<span class="co">#&gt;  $ VernName     : Factor w/ 110 levels "-","acacia franc",..: 102 79 14 91 18 97 14 86 75 70 ...</span>
<span class="co">#&gt;  $ GenSp        : Factor w/ 203 levels "Indet.-Indet.",..: 164 132 123 163 1 201 144 91 133 104 ...</span>
<span class="co">#&gt;  $ GensSpCor    : Factor w/ 227 levels "Indet.-Indet.",..: 164 132 123 163 185 201 144 91 133 104 ...</span>
<span class="co">#&gt;  $ BotaCorCode  : Factor w/ 6 levels "fullyDet","AssoByFam",..: 1 1 1 1 2 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ ValidAsso    : logi  FALSE FALSE FALSE FALSE TRUE FALSE ...</span>
<span class="co">#&gt;  $ TestData     : logi  FALSE FALSE FALSE FALSE TRUE FALSE ...</span>
<span class="co">#&gt;  - attr(*, ".internal.selfref")=&lt;externalptr&gt; </span>
<span class="co">#&gt;  - attr(*, "sorted")= chr "idTree"</span></code></pre></div>
<p>We can also calculate the percentage of good association for each tested tree, for this scenario:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="va">ResL</span><span class="op">)</span> <span class="co"># combine them in a single data.table</span>
<span class="co"># calculate the percentage of good association for each tested tree</span>
<span class="va">PropGood</span> <span class="op">&lt;-</span> <span class="va">Res</span><span class="op">[</span><span class="va">TestData</span><span class="op">==</span><span class="cn">TRUE</span> <span class="op">&amp;</span> <span class="va">ValidAsso</span><span class="op">==</span><span class="cn">TRUE</span>,
                <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>propOK<span class="op">=</span><span class="va">.N</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ResL</span><span class="op">)</span><span class="op">)</span>, 
                by<span class="op">=</span><span class="va">idTree</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">PropGood</span><span class="op">)</span>
<span class="co">#&gt;    idTree propOK</span>
<span class="co">#&gt; 1: 100626    0.8</span>
<span class="co">#&gt; 2: 100654    1.0</span>
<span class="co">#&gt; 3: 100787    0.5</span>
<span class="co">#&gt; 4: 100793    0.9</span>
<span class="co">#&gt; 5: 100796    1.0</span>
<span class="co">#&gt; 6: 100801    1.0</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<div id="refs" class="references">
<div id="ref-Aubry-Kientz2013">
<p>Aubry-Kientz, Mélaine, Bruno Hérault, Charles Ayotte-Trépanier, Christopher Baraloto, and Vivien Rossi. 2013. “Toward Trait-Based Mortality Models for Tropical Forests.” Edited by Francesco de Bello. <em>PLoS ONE</em> 8 (5): e63678. <a href="https://doi.org/10.1371/journal.pone.0063678" class="external-link">https://doi.org/10.1371/journal.pone.0063678</a>.</p>
</div>
<div id="ref-Madkaud2012">
<p>Madkaud, Jules-Maurice. 2012. “Mettre à plat les correspondances entre noms vernaculaires et identités botaniques des espèces présentes sur le site de Paracou (Guyane Française).” PhD thesis, Université des Antilles et de la Guyane.</p>
</div>
<div id="ref-Mirabel2018a">
<p>Mirabel, Ariane. 2018. “Réponse et Résilience de la Biodiversité d’une Forêt Tropicale après Perturbation.” PhD thesis, Université de Guyane.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Geraldine Derroire, Melaine Aubry-Kientz, Ariane Mirabel, Daniela Krebber, Eric Marcon, Bruno Herault.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
